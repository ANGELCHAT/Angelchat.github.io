---
weight: 32
category: "extending-ui"
subcategory: "extending-chat-widget"
title: "New Chat Widget JS API"
tagline: "Customize the behavior of the Chat Widget."
desc: "Adjust the mechanics of the widget or leverage the API to pass additional details on the visitor."
---

# Introduction

## About the API

The Chat Widget JavaScript API lets you interact with the Chat Widget embedded on your site.
It might come in handy whenever you want to gather some additional data using LiveChat, show or hide your Chat Widget on certain occasions, or amend its behavior in a way that is not provided by the standard settings.

This document focuses rather on the Developers and requires a basic knowledge of JavaScript. However if you would have any questions don't hesitate to start a chat with our Support Team or just add a new topic on [Developers Community](https://www.livechatinc.com/community/c/developers-api).

This API works only with the [new Chat Widget](https://developers.livechatinc.com/blog/new-chat-window-look/).

## Getting started

The API is accessed through the `LiveChatWidget` object.
It is being initialized within the LiveChat tracking code, which is used to install our Chat Widget on your site.
If you haven't installed the code yet, you can find it directly in the [LiveChat app](https://my.livechatinc.com/settings/code).

The API requires the newest version of the code snippet (â‰¥2.0). If you had installed the code a while ago and the API presented here doesn't work, you should either update the code or use the [old version of JS API](https://developers.livechatinc.com/docs/js-api/#introduction). You can check the current version of your snippet by calling the `scriptTagVersion` function:

```js
LiveChatWidget.scriptTagVersion()
```

The `LiveChatWidget` object comes with four methods:

- `on` registers a callback function for a specific event
- `off` removes a callback registered by `on`
- `call` allows you to trigger functions
- `get` makes it possible to fetch data

Using these methods is based on passing the correct arguments in the following pattern:
```js
LiveChatWidget.method('method', 'data')
```
For example, if you would like to set your Customer's name to `John Doe`, this is how it would look like:

```js
LiveChatWidget.call('set_visitor_name', 'John Doe')
```

# Methods

To change the visibility of the Chat Widget, you can use the following methods:

- [Maximize](#maximize)
- [Minimize](#minimize)
- [Hide](#hide)
- [Destroy](#destroy)

## Maximize

Maximizes the Chat Widget.

#### Example

```js
LiveChatWidget.call("maximize");
```

## Minimize

Minimizes the Chat Widget.

#### Example

```js
LiveChatWidget.call("minimize");
```

## Hide

It hides the Chat Widget on the site.
You will need to use either 'maximize' or 'minimze' API calls to show it afterwards.

#### Example

```js
LiveChatWidget.call("hide");
```

## Destroy

Destroys the Chat Widget.
It won't be available for further actions until the window is refreshed.

#### Example

```js
LiveChatWidget.call("destroy");
```

# Getters

You can use getters to fetch the data from the Chat Widget.

Available getters:

- [Get state](#get-state)
- [Get customer data](#get-customer-data)

## Get state

Returns the Chat Widget state.
This includes Widget visibility and license availability.

#### Example

```js
LiveChatWidget.get("state");
```

#### Response

| param        | type                                         | description                |
| ------------ | -------------------------------------------- | -------------------------- |
| availability | `'online'` \| `'offline'`                    | Group's availability       |
| visibility   | `'maximized'` \| `'minimized'` \| `'hidden'` | the Chat Widget visibility |

## Get customer data

Returns a filtered list of customer data.

#### Example

```js
LiveChatWidget.get("customer_data");
```

#### Response

| param            | type                                                      | description                              |
| ---------------- | --------------------------------------------------------- | ---------------------------------------- |
| id               | `string`                                                  | unique customer id                       |
| name             | `string`                                                  | customer name, as provided               |
| email            | `string`                                                  | customer e-mail address, as provided     |
| isReturning      | `boolean`                                                 | if this customer visited you before      |
| status           | `'queued'` \| `'chatting'` \| `'browsing'` \| `'invited'` | Customer's status                        |
| sessionVariables | `Record<string, string>`                                  | additional free-form session information |

# Setters

Various data can be sent over to the LiveChat integration so that your Agents can use it.
For more information, you can read these articles in our Help Center: https://www.livechatinc.com/help/custom-variables-configuration/

Available setters:

- [Set session variables](#set-session-variables)
- [Update session variables](#update-session-variables)
- [Set visitor name](#set-visitor-name)
- [Set visitor email](#set-visitor-email)

## Set session variables

Creates new session variables, or replaces the ones set previously.

```js
LiveChatWidget.call("set_session_variables", {
  username: "john.doe",
  cart_value: "450"
});
```

## Update session variables

Changes the values of your session variables.
Please note that the existing variables won't be replaced. The new session variables will be included together with the ones set previously.

#### Example

```js
LiveChatWidget.call("update_session_variables", {
  username: "j.doe",
  cart_value: "400"
});
```

## Set visitor name

Sets the Visitor's name.

#### Example

```js
LiveChatWidget.call("set_visitor_name", "John Doe");
```

## Set visitor email

Sets the Visitor's e-mail address.

#### Example

```js
LiveChatWidget.call("set_visitor_email", "john@example.com");
```

# Callbacks

Callbacks allow you to react to the events triggered by the Chat Widget.
You can use them to add custom behaviors when certain events happen.
This can be accomplished by subscribing a callback with the API.

Available callbacks:

- [On ready](#on-ready)
- [On availability changed](#on-availability-changed)
- [On visibility changed](#on-visibility-changed)
- [On customer status changed](#on-customer-status-changed)
- [On new event](#on-new-event)
- [On form submitted](#on-form-submitted)
- [On rating submitted](#on-rating-submitted)

## On ready

The Chat Widget has finished loading. If the Chat Widget is already loaded the provided handler function will be called immediately.
With this callback, you will receive the Chat Widget state and customer data as if requested by their getters.

#### Payload

| param        | type                               | description                        |
| ------------ | ---------------------------------- | ---------------------------------- |
| state        | [WidgetState](#get-state)          | the Chat Widget state              |
| customerData | [CustomerData](#get-customer-data) | Customer data from the Chat Widget |

```js
function onReady(initialData) {
  // Chat Widget is ready

  var state = initialData.state;
  var customerData = initialData.customerData;
}

LiveChatWidget.on("ready", onReady);
LiveChatWidget.off("ready", onReady);
```

## On availability changed

Availability has changed for the current group.

#### Payload

| param        | type                      | description             |
| ------------ | ------------------------- | ----------------------- |
| availability | `"online"` \| `"offline"` | Availability of a group |

```js
function onAvailabilityChanged(data) {
  if (data.availability === "online") {
    // we're available to chat!
  } else {
    // sadly, no agents are available at the moment.
  }
}

LiveChatWidget.on("availability_changed", onAvailabilityChanged);
LiveChatWidget.off("availability_changed", onAvailabilityChanged);
```

## On visibility changed

Called once the visibility of the Chat Widget has changed.
This applies to both user actions like maximizing or minimizing the window as well as hiding or showing the Chat Widget through the use of this API.

#### Payload

| param      | type                                         | description                |
| ---------- | -------------------------------------------- | -------------------------- |
| visibility | `"maximized"` \| `"minimized"` \| `"hidden"` | the Chat Widget visibility |

```js
function onVisibilityChanged(data) {
  switch (data.visibility) {
    case "maximized":
      break;
    case "minimized":
      break;
    case "hidden":
      break;
  }
}

LiveChatWidget.on("visibility_changed", onVisibilityChanged);
LiveChatWidget.off("visibility_changed", onVisibilityChanged);
```

## On customer status changed

Called once the status of your Customer has changed.
This can be used to track the following info:

- If and when Customers are being invited to chat
- If Customers are already chatting
- If they are waiting for an agent to become available in the queue

#### Payload

| param  | type                                                     | description       |
| ------ | -------------------------------------------------------- | ----------------- |
| status | `'queued'` \| `'chatting'` \| `'invited'` \|`'browsing'` | Customer's status |

```js
function onCustomerStatusChanged(data) {
  switch (data.status) {
    case "queued":
      // customer is in queue
      break;
    case "chatting":
      // customer is currently chatting
      break;
    case "invited":
      // customer received an invitation but didn't start the chat
      break;
    case "browsing":
      // customer is in idle state, not queued, not chatting, and didn't receive an invitation
      break;
  }
}

LiveChatWidget.on("customer_status_changed", onCustomerStatusChanged);
LiveChatWidget.off("customer_status_changed", onCustomerStatusChanged);
```

## On new event

Called for both incoming and outgoing events.

#### Payload

| param       | type                                        | description            |
| ----------- | ------------------------------------------- | ---------------------- |
| timestamp   | `number`                                    | Event's send timestamp |
| type        | `'message'` \| `'rich_message'` \| `'file'` | Event's type           |
| author.id   | `string`                                    | Event's author id      |
| author.type | `'customer'` \| `'agent'`                   | Event's author type    |

```js
function onNewEvent(event) {
  // do something
}

LiveChatWidget.on("new_event", onNewEvent);
LiveChatWidget.off("new_event", onNewEvent);
```

## On form submitted

Called after a form has been submitted in the chat.

Payload:

| param    | type                                      | description |
| -------- | ----------------------------------------- | ----------- |
| formType | `"prechat"` \| `"postchat"` \| `"ticket"` | Form's type |

```js
function onFormSubmitted(formType) {
  // do something
}

LiveChatWidget.on("form_submitted", onFormSubmitted);
LiveChatWidget.off("form_submitted", onFormSubmitted);
```

## On rating submitted

Called after the customer has rated the chat, or canceled the previous rating.

#### Payload

| param | type                            | description             |
| ----- | ------------------------------- | ----------------------- |
| value | `"good"` \| `"bad"` \| `"none"` | Customer's rating value |

```js
function onRatingSubmitted(value) {
  // do something
}

LiveChatWidget.on("rating_submitted", onRatingSubmitted);
LiveChatWidget.off("rating_submitted", onRatingSubmitted);
```

# Playground

Here's where you can play with the Chat Widget JavaScript API in an interactive environment. Use the buttons and inputs on the left side of the widget or try to invoke some functions directly in the console.

<iframe src="https://codesandbox.io/embed/static-ejhgy?autoresize=1&expanddevtools=1&fontsize=14&hidenavigation=1&view=preview" style="width: 100%; height: 750px; max-height: 100vh; border: 0; border-radius: 4px; overflow: hidden;"></iframe>

# Examples

Here you can find some example usage of the Chat Widget JavaScript API. They all require the Widget to be installed on the page and `window.LiveChatWidget` to be defined.

## Show the Widget after time

Show the Chat Widget after 30 seconds and keep it open after reloading.

```js
LiveChatWidget.on("visibility_changed", function(data) {
  if (data.visibility === "maximized") {
    localStorage.setItem("livechat_chat_visible", true);
  }
});

var isWidgetVisible = Boolean(localStorage.getItem("livechat_chat_visible"));

if (!isWidgetVisible) {
  setTimeout(function() {
    LiveChatWidget.call("maximize");
  }, 30000);
}
```

## Open the Widget using button

Show the hidden or minimized Widget after a button has been clicked.
You can change the Widget visibility as described in our [Help Center](https://www.livechatinc.com/help/chat-widget-visibility/)

```js
<html>
  <body>
    <button id="chat-btn">Chat with us!</button>
    <script>
      var chatButton = document.getElementById('chat-btn')
      chatButton.addEventListener('click', function(){" "}
      {LiveChatWidget.call("maximize")})
    </script>
  </body>
</html>
```

## Prefill username and email

Set the Customers name and email using their login and email.

```js
var user = JSON.parse(localStorage.getItem("user"));

LiveChatWidget.call("set_visitor_name", user.login);
LiveChatWidget.call("set_visitor_email", user.email);
```
